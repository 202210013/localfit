<div class="admin-container">
  <!-- Header with Navigation -->
  <div class="admin-header">
    <h2>Admin Dashboard</h2>
    <div class="nav-buttons">
      <button 
        [class.active]="currentView === 'analytics'" 
        (click)="switchToAnalytics()"
        class="nav-btn">
        <i class="fa-solid fa-chart-line"></i> Analytics
      </button>
      <button 
        [class.active]="currentView === 'orders'" 
        (click)="switchToOrders()"
        class="nav-btn">
        <i class="fa-solid fa-list"></i> Orders
      </button>
      <button 
        [class.active]="currentView === 'report'" 
        (click)="switchToReport()"
        class="nav-btn">
        <i class="fa-solid fa-file-lines"></i> Sales Report
      </button>
      <button 
        (click)="switchToProducts()"
        class="nav-btn">
        <i class="fa-solid fa-box"></i> My Products
      </button>
      <button (click)="exportToExcel()" class="action-btn">
        <i class="fa-solid fa-download"></i> Export Excel
      </button>
      <button class="logout-btn" (click)="logout()">
        <i class="fa-solid fa-sign-out"></i> Logout
      </button>
    </div>
  </div>

  <!-- Analytics View -->
  <div *ngIf="currentView === 'analytics'" class="analytics-section">
    <!-- Date Filter -->
    <div class="date-filter">
      <label>Time Period:</label>
      <select [(ngModel)]="dateFilter" (ngModelChange)="onDateFilterChange(dateFilter)" class="date-select">
        <option value="today">Today</option>
        <option value="week">Last 7 Days</option>
        <option value="month">Last Month</option>
        <option value="year">Last Year</option>
        <option value="all">All Time</option>
      </select>
    </div>

    <!-- Key Metrics Cards -->
    <div class="metrics-grid">
      <div class="metric-card revenue">
        <div class="metric-icon">
          <i class="fa-solid fa-peso-sign"></i>
        </div>
        <div class="metric-content">
          <h3>Total Revenue</h3>
          <p class="metric-value">₱{{ analytics.totalRevenue | number:'1.2-2' }}</p>
        </div>
      </div>
      
      <div class="metric-card orders">
        <div class="metric-icon">
          <i class="fa-solid fa-shopping-cart"></i>
        </div>
        <div class="metric-content">
          <h3>Total Orders</h3>
          <p class="metric-value">{{ analytics.totalOrders }}</p>
        </div>
      </div>
      
      <div class="metric-card approved">
        <div class="metric-icon">
          <i class="fa-solid fa-check-circle"></i>
        </div>
        <div class="metric-content">
          <h3>Approved Orders</h3>
          <p class="metric-value">{{ analytics.approvedOrders }}</p>
        </div>
      </div>
      
      <div class="metric-card average">
        <div class="metric-icon">
          <i class="fa-solid fa-calculator"></i>
        </div>
        <div class="metric-content">
          <h3>Avg Order Value</h3>
          <p class="metric-value">₱{{ analytics.averageOrderValue | number:'1.2-2' }}</p>
        </div>
      </div>
    </div>

    <!-- Analytics Charts Section -->
    <div class="analytics-grid">
      <!-- Top Products -->
      <div class="analytics-card">
        <h3><i class="fa-solid fa-trophy"></i> Top Products</h3>
        <div class="top-products">
          <div *ngFor="let item of analytics.topProducts; let i = index" class="product-item">
            <div class="product-rank">{{ i + 1 }}</div>
            <div class="product-info">
              <span class="product-name">{{ item.product }}</span>
              <div class="product-stats">
                <span class="quantity">{{ item.quantity }} sold</span>
                <span class="revenue">₱{{ item.revenue | number:'1.2-2' }}</span>
              </div>
            </div>
            <div class="product-bar">
              <div class="bar-fill" [style.width.%]="analytics.topProducts[0] ? (item.revenue / analytics.topProducts[0].revenue) * 100 : 0"></div>
            </div>
          </div>
          <div *ngIf="analytics.topProducts.length === 0" class="no-data">
            No product data available
          </div>
        </div>
      </div>

      <!-- Size Sales -->
      <div class="analytics-card">
        <h3><i class="fa-solid fa-ruler"></i> Sales by Size</h3>
        <div class="size-sales">
          <div *ngFor="let item of analytics.sizeSales" class="size-item">
            <div class="size-label">{{ item.size }}</div>
            <div class="size-stats">
              <span class="quantity">{{ item.quantity }} units</span>
              <span class="revenue">₱{{ item.revenue | number:'1.2-2' }}</span>
            </div>
            <div class="size-bar">
              <div class="bar-fill" [style.width.%]="analytics.sizeSales[0] ? (item.quantity / analytics.sizeSales[0].quantity) * 100 : 0"></div>
            </div>
          </div>
          <div *ngIf="analytics.sizeSales.length === 0" class="no-data">
            No size data available
          </div>
        </div>
      </div>

        <!-- Daily Sales -->
        <div class="analytics-card full-width">
          <div class="chart-header">
            <h3><i class="fa-solid fa-chart-column"></i> Daily Sales Performance</h3>
            <div class="chart-controls">
              <!-- Chart View Toggle -->
              <div class="chart-toggle">
                <button 
                  [class.active]="chartView === 'daily'" 
                  (click)="switchChartView('daily')"
                  class="toggle-btn">
                  <i class="fa-solid fa-calendar-day"></i> Daily
                </button>
                <button 
                  [class.active]="chartView === 'monthly'" 
                  (click)="switchChartView('monthly')"
                  class="toggle-btn">
                  <i class="fa-solid fa-calendar"></i> Monthly
                </button>
              </div>
              
              <div class="trend-indicator" *ngIf="chartView === 'daily'">
                <i class="fas" [ngClass]="getTrendIcon()" [style.color]="getTrendColor()"></i>
                <span [style.color]="getTrendColor()">
                  {{analytics.salesTrend.percentage}}% 
                  <span class="trend-text">{{analytics.salesTrend.trend === 'up' ? 'increase' : analytics.salesTrend.trend === 'down' ? 'decrease' : 'stable'}}</span>
                </span>
              </div>
              
              <button (click)="exportCurrentChart()" class="export-chart-btn" 
                      [title]="'Export ' + (chartView === 'daily' ? 'Daily' : 'Monthly') + ' Sales Data'">
                <i class="fa-solid fa-download"></i>
              </button>
            </div>
          </div>

          <!-- Enhanced Daily Sales Summary -->
          <div class="daily-summary" *ngIf="chartView === 'daily'">
            <div class="summary-grid">
              <div class="summary-item best-day">
                <div class="summary-icon">
                  <i class="fa-solid fa-star"></i>
                </div>
                <div class="summary-content">
                  <h4>Best Day</h4>
                  <p class="summary-value">{{analytics.peakSalesDay ? getDayName(analytics.peakSalesDay.date) : 'N/A'}}</p>
                  <small *ngIf="analytics.peakSalesDay">₱{{analytics.peakSalesDay.revenue | number:'1.2-2'}}</small>
                </div>
              </div>
              
              <div class="summary-item daily-avg">
                <div class="summary-icon">
                  <i class="fa-solid fa-calculator"></i>
                </div>
                <div class="summary-content">
                  <h4>Daily Average</h4>
                  <p class="summary-value">₱{{analytics.dailySales.length > 0 ? ((analytics.totalRevenue / analytics.dailySales.length) | number:'1.2-2') : '0'}}</p>
                  <small>per day</small>
                </div>
              </div>
              
              <div class="summary-item active-days">
                <div class="summary-icon">
                  <i class="fa-solid fa-calendar-check"></i>
                </div>
                <div class="summary-content">
                  <h4>Active Days</h4>
                  <p class="summary-value">{{getActiveDaysCount()}}/{{analytics.dailySales.length}}</p>
                  <small>had sales</small>
                </div>
              </div>
              
              <div class="summary-item growth-rate">
                <div class="summary-icon">
                  <i class="fa-solid fa-trending-up"></i>
                </div>
                <div class="summary-content">
                  <h4>Growth Rate</h4>
                  <p class="summary-value" [style.color]="getGrowthColor()">
                    {{getWeekOverWeekGrowth()}}%
                  </p>
                  <small>vs last week</small>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Chart Statistics -->
          <div class="chart-stats">
            <div class="stat-item" *ngIf="chartView === 'daily'">
              <span class="stat-label">Peak Day:</span>
              <span class="stat-value">
                {{analytics.peakSalesDay ? formatDate(analytics.peakSalesDay.date) : 'N/A'}}
                <small *ngIf="analytics.peakSalesDay">(₱{{analytics.peakSalesDay.revenue | number:'1.2-2'}})</small>
              </span>
            </div>
            <div class="stat-item" *ngIf="chartView === 'monthly'">
              <span class="stat-label">Peak Month:</span>
              <span class="stat-value">
                {{analytics.peakSalesMonth ? analytics.peakSalesMonth.month : 'N/A'}}
                <small *ngIf="analytics.peakSalesMonth">(₱{{analytics.peakSalesMonth.revenue | number:'1.2-2'}})</small>
              </span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Total {{chartView === 'daily' ? 'Days' : 'Months'}}:</span>
              <span class="stat-value">{{chartView === 'daily' ? analytics.dailySales.length : analytics.monthlySales.length}}</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Avg {{chartView === 'daily' ? 'Daily' : 'Monthly'}}:</span>
              <span class="stat-value">₱{{chartView === 'daily' ? 
                (analytics.dailySales.length > 0 ? ((analytics.totalRevenue / analytics.dailySales.length) | number:'1.2-2') : '0') :
                (analytics.monthlySales.length > 0 ? ((analytics.totalRevenue / analytics.monthlySales.length) | number:'1.2-2') : '0')
              }}</span>
            </div>
          </div>
        
        <!-- Daily Sales Chart -->
        <div class="daily-sales" *ngIf="chartView === 'daily'">
          <div class="sales-chart">
            <div *ngFor="let day of analytics.dailySales" 
                 class="day-item"
                 (click)="onDayClick(day)"
                 [class.selected]="selectedDay?.date === day.date">
              <div class="day-bar">
                <div class="bar-fill" 
                     [style.height.%]="getDailySalesChartHeight(day.revenue)"
                     [style.background-color]="getBarColor(day)"
                     [title]="'Date: ' + day.date + ', Revenue: ₱' + (day.revenue | number:'1.2-2') + ', Orders: ' + day.orders">
                  <div class="bar-label" *ngIf="day.revenue > 0">₱{{day.revenue | number:'1.0-0'}}</div>
                </div>
              </div>
              <div class="day-label">{{ getDayName(day.date) }}</div>
              <div class="day-date">{{ formatDate(day.date) }}</div>
            </div>
          </div>
          
          <div *ngIf="analytics.dailySales.length === 0" class="no-data">
            <i class="fa-solid fa-chart-column"></i>
            <p>No daily sales data available for the selected period</p>
            <small>Try selecting a different time period or add some orders</small>
          </div>
        </div>

        <!-- Monthly Sales Chart -->
        <div class="monthly-sales" *ngIf="chartView === 'monthly'">
          <div class="sales-chart">
            <div *ngFor="let month of analytics.monthlySales" 
                 class="month-item"
                 (click)="onMonthClick(month)"
                 [class.selected]="selectedMonth?.month === month.month">
              <div class="month-bar">
                <div class="bar-fill" 
                     [style.height.%]="getMonthlySalesChartHeight(month.revenue)"
                     [style.background-color]="getBarColor(month)"
                     [title]="'Month: ' + month.period + ', Revenue: ₱' + (month.revenue | number:'1.2-2') + ', Orders: ' + month.orders">
                  <div class="bar-label" *ngIf="month.revenue > 0">₱{{month.revenue | number:'1.0-0'}}</div>
                </div>
              </div>
              <div class="month-label">{{ month.period }}</div>
            </div>
          </div>
          
          <div *ngIf="analytics.monthlySales.length === 0" class="no-data">
            <i class="fa-solid fa-chart-column"></i>
            <p>No monthly sales data available for the selected period</p>
            <small>Try selecting a different time period or add some orders</small>
          </div>
        </div>
        
        <!-- Selected Day Details -->
        <div *ngIf="selectedDay" class="selected-details">
          <h4><i class="fa-solid fa-calendar-day"></i> {{formatDate(selectedDay.date)}} Details</h4>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">Revenue:</span>
              <span class="detail-value revenue">₱{{selectedDay.revenue | number:'1.2-2'}}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Orders:</span>
              <span class="detail-value">{{selectedDay.orders}}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Avg Order Value:</span>
              <span class="detail-value">₱{{selectedDay.orders > 0 ? ((selectedDay.revenue / selectedDay.orders) | number:'1.2-2') : '0'}}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Day:</span>
              <span class="detail-value">{{getDayName(selectedDay.date)}}</span>
            </div>
          </div>
          <button (click)="selectedDay = null" class="close-detail-btn">
            <i class="fa-solid fa-times"></i>
          </button>
        </div>

        <!-- Selected Month Details -->
        <div *ngIf="selectedMonth" class="selected-details">
          <h4><i class="fa-solid fa-calendar"></i> {{selectedMonth.period}} Details</h4>
          <div class="detail-grid">
            <div class="detail-item">
              <span class="detail-label">Revenue:</span>
              <span class="detail-value revenue">₱{{selectedMonth.revenue | number:'1.2-2'}}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Orders:</span>
              <span class="detail-value">{{selectedMonth.orders}}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Avg Order Value:</span>
              <span class="detail-value">₱{{selectedMonth.orders > 0 ? ((selectedMonth.revenue / selectedMonth.orders) | number:'1.2-2') : '0'}}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Period:</span>
              <span class="detail-value">{{selectedMonth.period}}</span>
            </div>
          </div>
          <button (click)="selectedMonth = null" class="close-detail-btn">
            <i class="fa-solid fa-times"></i>
          </button>
        </div>
      </div>

      <!-- Monthly Revenue -->
      <div class="analytics-card full-width" *ngIf="analytics.monthlyRevenue.length > 0">
        <h3><i class="fa-solid fa-calendar"></i> Monthly Revenue</h3>
        <div class="monthly-revenue">
          <div *ngFor="let month of analytics.monthlyRevenue" class="month-item">
            <span class="month-label">{{ formatMonth(month.month) }}</span>
            <span class="month-revenue">₱{{ month.revenue | number:'1.2-2' }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Professional Sales Report View -->
  <div *ngIf="currentView === 'report'" class="report-section">
    <!-- Report Header -->
    <div class="report-header">
      <div class="report-title">
        <h2><i class="fa-solid fa-file-contract"></i> Professional Sales Report</h2>
        <p class="report-subtitle">Comprehensive Business Performance Analysis</p>
      </div>
      <div class="report-actions">
        <div class="report-period">
          <label>Report Period:</label>
          <select [(ngModel)]="dateFilter" (ngModelChange)="onDateFilterChange(dateFilter); generateProfessionalReport()" class="period-select">
            <option value="today">Today</option>
            <option value="week">Last 7 Days</option>
            <option value="month">Last Month</option>
            <option value="year">Last Year</option>
            <option value="all">All Time</option>
          </select>
        </div>
        <button (click)="exportProfessionalReport()" class="export-report-btn">
          <i class="fa-solid fa-file-export"></i> Export Report
        </button>
        <button (click)="generateProfessionalReport()" class="refresh-report-btn">
          <i class="fa-solid fa-refresh"></i> Refresh
        </button>
      </div>
    </div>

    <!-- Executive Summary -->
    <div class="executive-summary">
      <h3><i class="fa-solid fa-star"></i> Executive Summary</h3>
      
      <div class="summary-overview">
        <div class="summary-metrics">
          <div class="metric-item">
            <div class="metric-label">Total Revenue</div>
            <div class="metric-value">₱{{ report.executiveSummary.totalRevenue | number:'1.2-2' }}</div>
          </div>
          <div class="metric-item">
            <div class="metric-label">Total Orders</div>
            <div class="metric-value">{{ report.executiveSummary.totalOrders }}</div>
          </div>
          <div class="metric-item">
            <div class="metric-label">Growth Rate</div>
            <div class="metric-value" [style.color]="getGrowthColor()">{{ report.executiveSummary.growthRate }}%</div>
          </div>
          <div class="metric-item">
            <div class="metric-label">Performance</div>
            <div class="metric-value performance" [ngClass]="report.executiveSummary.performanceRating.toLowerCase()">
              {{ report.executiveSummary.performanceRating }}
            </div>
          </div>
        </div>
        
        <div class="report-metadata">
          <p><strong>Generated:</strong> {{ report.generatedDate }}</p>
          <p><strong>Period:</strong> {{ report.reportPeriod }}</p>
        </div>
      </div>

      <div class="key-findings">
        <h4><i class="fa-solid fa-lightbulb"></i> Key Findings</h4>
        <ul class="findings-list">
          <li *ngFor="let finding of report.executiveSummary.keyFindings" class="finding-item">
            <i class="fa-solid fa-check-circle"></i>
            {{ finding }}
          </li>
        </ul>
      </div>
    </div>

    <!-- Report Body -->
    <div class="report-body">
      
      <!-- Sales Overview Section -->
      <div class="report-section-card">
        <h3><i class="fa-solid fa-chart-pie"></i> Sales Overview</h3>
        <div class="section-content">
          <div class="overview-grid">
            <div class="overview-item">
              <span class="label">Total Revenue</span>
              <span class="value">₱{{ report.sections.salesOverview.totalRevenue | number:'1.2-2' }}</span>
            </div>
            <div class="overview-item">
              <span class="label">Total Orders</span>
              <span class="value">{{ report.sections.salesOverview.totalOrders }}</span>
            </div>
            <div class="overview-item">
              <span class="label">Approved Orders</span>
              <span class="value">{{ report.sections.salesOverview.approvedOrders }}</span>
            </div>
            <div class="overview-item">
              <span class="label">Pending Orders</span>
              <span class="value">{{ report.sections.salesOverview.pendingOrders }}</span>
            </div>
            <div class="overview-item">
              <span class="label">Avg Order Value</span>
              <span class="value">₱{{ report.sections.salesOverview.averageOrderValue | number:'1.2-2' }}</span>
            </div>
            <div class="overview-item">
              <span class="label">Conversion Rate</span>
              <span class="value">{{ report.sections.salesOverview.conversionRate | number:'1.1-1' }}%</span>
            </div>
            <div class="overview-item">
              <span class="label">Active Days</span>
              <span class="value">{{ report.sections.salesOverview.activeDays }}/{{ report.sections.salesOverview.totalDays }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Performance Analysis Section -->
      <div class="report-section-card">
        <h3><i class="fa-solid fa-tachometer-alt"></i> Performance Analysis</h3>
        <div class="section-content">
          <div class="performance-grid">
            <div class="performance-item">
              <h4>Best Performance Day</h4>
              <p *ngIf="report.sections.performanceAnalysis.bestDay" class="best-day">
                {{ formatDate(report.sections.performanceAnalysis.bestDay.date) }}
                <span class="amount">₱{{ report.sections.performanceAnalysis.bestDay.revenue | number:'1.2-2' }}</span>
              </p>
              <p *ngIf="!report.sections.performanceAnalysis.bestDay">No data available</p>
            </div>
            
            <div class="performance-item">
              <h4>Sales Consistency</h4>
              <div class="consistency-meter">
                <div class="meter-bar">
                  <div class="meter-fill" [style.width.%]="report.sections.performanceAnalysis.salesConsistency"></div>
                </div>
                <span class="consistency-value">{{ report.sections.performanceAnalysis.salesConsistency | number:'1.1-1' }}%</span>
              </div>
            </div>

            <div class="performance-item">
              <h4>Sales Streaks</h4>
              <p>Current: <strong>{{ report.sections.performanceAnalysis.currentStreak }} days</strong></p>
              <p>Longest: <strong>{{ report.sections.performanceAnalysis.longestStreak }} days</strong></p>
            </div>

            <div class="performance-item">
              <h4>Daily Average</h4>
              <p class="daily-avg">₱{{ report.sections.performanceAnalysis.averageDailySales | number:'1.2-2' }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Charts Section -->
      <div class="report-section-card full-width">
        <h3><i class="fa-solid fa-chart-bar"></i> Visual Analytics</h3>
        <div class="charts-container">
          
          <!-- Daily Sales Chart -->
          <div class="chart-item">
            <h4>Daily Sales Performance</h4>
            <div class="mini-chart">
              <div *ngFor="let day of report.charts.dailySalesChart" class="mini-bar">
                <div class="bar-mini" 
                     [style.height.%]="(day.revenue / report.executiveSummary.totalRevenue * 100 * 5) || 0"
                     [style.background-color]="getPerformanceColor(day.revenue)"
                     [title]="formatDate(day.date) + ': ₱' + (day.revenue | number:'1.2-2')">
                </div>
              </div>
            </div>
          </div>

          <!-- Product Performance Chart -->
          <div class="chart-item">
            <h4>Top Products Performance</h4>
            <div class="product-chart">
              <div *ngFor="let product of report.charts.productPerformanceChart.slice(0, 5)" class="product-bar-item">
                <span class="product-name">{{ product.product | slice:0:15 }}{{ product.product.length > 15 ? '...' : '' }}</span>
                <div class="product-bar">
                  <div class="bar-fill" 
                       [style.width.%]="report.charts.productPerformanceChart[0] ? (product.revenue / report.charts.productPerformanceChart[0].revenue * 100) : 0">
                  </div>
                </div>
                <span class="product-value">₱{{ product.revenue | number:'1.0-0' }}</span>
              </div>
            </div>
          </div>

          <!-- Size Distribution Chart -->
          <div class="chart-item" *ngIf="report.charts.sizeDistributionChart.length > 0">
            <h4>Size Distribution</h4>
            <div class="size-chart">
              <div *ngFor="let size of report.charts.sizeDistributionChart" class="size-item">
                <span class="size-label">{{ size.size }}</span>
                <div class="size-bar">
                  <div class="bar-fill" 
                       [style.width.%]="report.charts.sizeDistributionChart[0] ? (size.quantity / report.charts.sizeDistributionChart[0].quantity * 100) : 0">
                  </div>
                </div>
                <span class="size-count">{{ size.quantity }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Data Table Section -->
      <div class="report-section-card full-width">
        <h3><i class="fa-solid fa-table"></i> Detailed Sales Data</h3>
        <div class="data-table-container">
          <table class="report-table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Day</th>
                <th>Revenue</th>
                <th>Orders</th>
                <th>Avg Order</th>
                <th>Performance</th>
                <th>vs Average</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let row of report.dataTable">
                <td>{{ row.Date }}</td>
                <td>{{ row.Day }}</td>
                <td class="revenue">{{ row.Revenue }}</td>
                <td>{{ row.Orders }}</td>
                <td>{{ row['Avg Order Value'] }}</td>
                <td>
                  <span class="performance-badge" [ngClass]="row.Performance.toLowerCase()">
                    {{ row.Performance }}
                  </span>
                </td>
                <td [style.color]="row['vs Average'].includes('-') ? '#dc3545' : '#28a745'">
                  {{ row['vs Average'] }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Insights Section -->
      <div class="report-section-card">
        <h3><i class="fa-solid fa-brain"></i> Key Insights & Analysis</h3>
        <div class="insights-content">
          <div *ngFor="let insight of report.insights" class="insight-item">
            <i class="fa-solid fa-arrow-right"></i>
            <p>{{ insight }}</p>
          </div>
        </div>
      </div>

      <!-- Recommendations Section -->
      <div class="report-section-card">
        <h3><i class="fa-solid fa-lightbulb"></i> Strategic Recommendations</h3>
        <div class="recommendations-content">
          <div *ngFor="let recommendation of report.sections.recommendations" class="recommendation-item">
            <i class="fa-solid fa-star"></i>
            <p>{{ recommendation }}</p>
          </div>
        </div>
      </div>

      <!-- Conclusions & Action Items -->
      <div class="report-section-card">
        <h3><i class="fa-solid fa-flag-checkered"></i> Conclusions & Action Items</h3>
        
        <div class="conclusions-section">
          <h4>Conclusions</h4>
          <div *ngFor="let conclusion of report.conclusions" class="conclusion-item">
            <i class="fa-solid fa-check-circle"></i>
            <p>{{ conclusion }}</p>
          </div>
        </div>

        <div class="action-items-section">
          <h4>Immediate Action Items</h4>
          <div class="action-grid">
            <div *ngFor="let action of report.actionablePoints; let i = index" class="action-item">
              <div class="action-priority">{{ i + 1 }}</div>
              <div class="action-content">
                <p>{{ action }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- Report Footer -->
    <div class="report-footer">
      <p class="footer-text">
        <i class="fa-solid fa-info-circle"></i>
        This report was automatically generated based on your sales data for {{ report.reportPeriod }}. 
        Data is accurate as of {{ report.generatedDate }}.
      </p>
      <div class="footer-actions">
        <button (click)="exportProfessionalReport()" class="export-footer-btn">
          <i class="fa-solid fa-download"></i> Export Full Report
        </button>
      </div>
    </div>
  </div>

  <!-- Orders View -->
  <div *ngIf="currentView === 'orders'" class="orders-section">
    <div class="orders-header">
      <h3><i class="fa-solid fa-list-check"></i> Order Management</h3>
      <div class="order-stats">
        <div class="stat-badge all" [class.active]="statusFilter === 'all'" (click)="filterByStatus('all')">
          <span class="stat-count">{{ getStatusCount('all') }}</span>
          <span class="stat-label">Total</span>
        </div>
        <div class="stat-badge pending" [class.active]="statusFilter === 'pending'" (click)="filterByStatus('pending')">
          <span class="stat-count">{{ getStatusCount('pending') }}</span>
          <span class="stat-label">Pending</span>
        </div>
        <div class="stat-badge approved" [class.active]="statusFilter === 'approved'" (click)="filterByStatus('approved')">
          <span class="stat-count">{{ getStatusCount('approved') }}</span>
          <span class="stat-label">Approved</span>
        </div>
        <div class="stat-badge declined" [class.active]="statusFilter === 'declined'" (click)="filterByStatus('declined')">
          <span class="stat-count">{{ getStatusCount('declined') }}</span>
          <span class="stat-label">Declined</span>
        </div>
        <div class="stat-badge ready-pickup" [class.active]="statusFilter === 'ready-for-pickup'" (click)="filterByStatus('ready-for-pickup')">
          <span class="stat-count">{{ getStatusCount('ready-for-pickup') }}</span>
          <span class="stat-label">Ready for Pickup</span>
        </div>
        <div class="stat-badge completed" [class.active]="statusFilter === 'completed'" (click)="filterByStatus('completed')">
          <span class="stat-count">{{ getStatusCount('completed') }}</span>
          <span class="stat-label">Completed</span>
        </div>
      </div>
    </div>

    <!-- Search and Filter Controls -->
    <div class="order-controls">
      <div class="search-container">
        <i class="fa-solid fa-search search-icon"></i>
        <input 
          type="text" 
          [(ngModel)]="searchTerm"
          (input)="searchOrders(searchTerm)"
          placeholder="Search orders by ID, customer, product, size..."
          class="search-input">
        <button *ngIf="searchTerm" (click)="searchTerm=''; searchOrders('')" class="clear-search">
          <i class="fa-solid fa-times"></i>
        </button>
      </div>
      
      <div class="filter-controls">
        <select [(ngModel)]="statusFilter" (ngModelChange)="filterByStatus(statusFilter)" class="status-filter">
          <option value="all">All Status</option>
          <option value="pending">Pending Only</option>
          <option value="approved">Approved Only</option>
          <option value="declined">Declined Only</option>
          <option value="ready-for-pickup">Ready for Pickup Only</option>
          <option value="completed">Completed Only</option>
        </select>
        
        <button (click)="clearFilters()" class="clear-filters-btn" [disabled]="searchTerm === '' && statusFilter === 'all' && sortField === 'id'">
          <i class="fa-solid fa-filter-circle-xmark"></i> Clear Filters
        </button>
      </div>
    </div>

    <!-- Results Info -->
    <div class="results-info" *ngIf="filteredOrders.length !== customerOrders.length || searchTerm || statusFilter !== 'all'">
      <i class="fa-solid fa-info-circle"></i>
      Showing {{ filteredOrders.length }} of {{ customerOrders.length }} orders
      <span *ngIf="searchTerm"> matching "{{ searchTerm }}"</span>
      <span *ngIf="statusFilter !== 'all'"> with status "{{ statusFilter }}"</span>
    </div>

    <div class="table-container">
      <table class="sortable-table">
        <thead>
          <tr>
            <th class="sortable" (click)="sortOrders('id')" [class.active]="sortField === 'id'">
              Order #
              <i class="fa-solid" [ngClass]="getSortIcon('id')"></i>
            </th>
            <th class="sortable" (click)="sortOrders('customer')" [class.active]="sortField === 'customer'">
              Customer
              <i class="fa-solid" [ngClass]="getSortIcon('customer')"></i>
            </th>
            <th class="sortable" (click)="sortOrders('product')" [class.active]="sortField === 'product'">
              Product
              <i class="fa-solid" [ngClass]="getSortIcon('product')"></i>
            </th>
            <th class="sortable" (click)="sortOrders('quantity')" [class.active]="sortField === 'quantity'">
              Quantity
              <i class="fa-solid" [ngClass]="getSortIcon('quantity')"></i>
            </th>
            <th class="sortable" (click)="sortOrders('size')" [class.active]="sortField === 'size'">
              Size
              <i class="fa-solid" [ngClass]="getSortIcon('size')"></i>
            </th>
            <th class="sortable" (click)="sortOrders('status')" [class.active]="sortField === 'status'">
              Status
              <i class="fa-solid" [ngClass]="getSortIcon('status')"></i>
            </th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let order of filteredOrders; trackBy: trackByOrderId" class="order-row">
            <td data-label="Order #" class="order-id">
              <span class="id-badge">{{ order.id }}</span>
            </td>
            <td data-label="Customer" class="customer-name">
              <i class="fa-solid fa-user"></i>
              {{ order.customer }}
            </td>
            <td data-label="Product" class="product-name">
              <i class="fa-solid fa-box"></i>
              {{ order.product }}
            </td>
            <td data-label="Quantity" class="quantity">
              <span class="qty-badge">{{ order.quantity }}</span>
            </td>
            <td data-label="Size" class="size">
              <span class="size-badge" *ngIf="order.size">{{ order.size }}</span>
              <span class="no-size" *ngIf="!order.size">N/A</span>
            </td>
            <td data-label="Status" class="status">
              <span class="status-badge" [ngClass]="getStatusBadgeClass(order.status)">
                <i class="fa-solid" [ngClass]="{
                  'fa-clock': order.status === 'pending',
                  'fa-check-circle': order.status === 'approved', 
                  'fa-times-circle': order.status === 'declined',
                  'fa-box-open': order.status === 'ready-for-pickup',
                  'fa-check-double': order.status === 'completed'
                }"></i>
                {{ order.status === 'ready-for-pickup' ? 'Ready for Pickup' : (order.status | titlecase) }}
              </span>
            </td>
            <td data-label="Action" class="actions">
              <div class="action-buttons">
                <button 
                  *ngIf="order.status === 'pending'" 
                  (click)="approveOrder(order)"
                  class="approve-btn"
                  title="Approve Order">
                  <i class="fa-solid fa-check"></i>
                  <span>Approve</span>
                </button>
                <button 
                  *ngIf="order.status === 'pending'" 
                  (click)="declineOrder(order)" 
                  class="decline-btn"
                  title="Decline Order">
                  <i class="fa-solid fa-times"></i>
                  <span>Decline</span>
                </button>
                <button 
                  *ngIf="order.status === 'approved'" 
                  (click)="markReadyForPickup(order)" 
                  class="pickup-btn"
                  title="Mark as Ready for Pickup">
                  <i class="fa-solid fa-box-open"></i>
                  <span>Ready for Pickup</span>
                </button>
                <span *ngIf="order.status === 'approved'" class="status-final approved-final">
                  <i class="fa-solid fa-check-circle"></i>
                  Approved
                </span>
                <span *ngIf="order.status === 'declined'" class="status-final declined-final">
                  <i class="fa-solid fa-times-circle"></i>
                  Declined
                </span>
                <span *ngIf="order.status === 'ready-for-pickup'" class="status-final pickup-final">
                  <i class="fa-solid fa-box-open"></i>
                  Ready for Pickup
                </span>
                <span *ngIf="order.status === 'completed'" class="status-final completed-final">
                  <i class="fa-solid fa-check-double"></i>
                  Order Completed
                </span>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      
      <div *ngIf="filteredOrders.length === 0 && customerOrders.length === 0" class="no-orders">
        <i class="fa-solid fa-inbox"></i>
        <h4>No Orders Found</h4>
        <p>No orders found for your products. Orders will appear here once customers place them.</p>
      </div>

      <div *ngIf="filteredOrders.length === 0 && customerOrders.length > 0" class="no-results">
        <i class="fa-solid fa-search"></i>
        <h4>No Results Found</h4>
        <p>No orders match your current search and filter criteria.</p>
        <button (click)="clearFilters()" class="clear-btn">
          <i class="fa-solid fa-filter-circle-xmark"></i>
          Clear Filters
        </button>
      </div>
    </div>
  </div>
</div>
